import exocounts
import convmag
import nstar
import pandas as pd
import matplotlib.pyplot as plt
from astropy import constants as const
from astropy import units as u


dat=pd.read_csv("nearby_updateA.txt",delimiter="|")
MIR=10.47*u.micron

fig=plt.figure()
for i in range(0,len(dat["name"])):
#    if True:
    try:
        star=exocounts.TargetClass()
        star.name=dat["name"][i]
        star.teff = dat["t"][i]*u.K #K ## optimistic (no cloud)
        star.rstar = dat["r"][i]*const.R_sun
        star.d = dat["dpc"][i]*u.pc #pc
        flux=nstar.getflux(star,MIR)
        fluxc=(flux.value)
        amin=dat["amin"][i]
        d=dat["dpc"][i]
        print(amin,d)
        sep=float(amin)/float(d)
        plt.plot([sep],[fluxc],".",color="C0")
        plt.text(sep,fluxc,dat["propername"][i])
        print("OK:",dat["name"][i])

    except:
        print("Error:",dat["name"][i])
plt.xscale("log")
plt.yscale("log")

plt.show()
